let balance = localStorage.getItem('balance') ? parseInt(localStorage.getItem('balance')) : 100;

function loadGame() {
    const gameArea = document.getElementById('gameArea');
    const resultArea = document.getElementById('result');
    gameArea.innerHTML = ''; // Clear previous game
    resultArea.innerHTML = ''; // Clear previous result

    const game = document.getElementById('gameSelector').value;
    if (game === 'coinFlip') {
        document.body.style.backgroundColor = "#e0f7fa"; // Light blue
        coinFlipGame();
    } else if (game === 'diceRoll') {
        document.body.style.backgroundColor = "#fce4ec"; // Light pink
        diceRollGame();
    } else if (game === 'roulette') {
        document.body.style.backgroundColor = "#f1f8e9"; // Light green
        rouletteGame();
    } else if (game === 'poker') {
        document.body.style.backgroundColor = "#fff9c4"; // Light yellow
        pokerGame();
    } else if (game === 'blackjack') {
        document.body.style.backgroundColor = "#ffccbc"; // Light orange
        blackjackGame();
    }
    updateBalanceDisplay();
}

function updateBalanceDisplay() {
    const resultArea = document.getElementById('result');
    resultArea.innerHTML = 'Current Balance: $' + balance;
    localStorage.setItem('balance', balance); // Save balance to localStorage
}

function blackjackGame() {
    const gameArea = document.getElementById('gameArea');
    const resultArea = document.getElementById('result');
    
    const betInput = document.createElement('input');
    betInput.type = 'number';
    betInput.placeholder = 'Enter your bet';
    betInput.min = 1;

    const button = document.createElement('button');
    button.innerText = 'Deal Cards';
    button.onclick = function () {
        const bet = parseInt(betInput.value);
        if (bet > balance || bet <= 0 || isNaN(bet)) {
            resultArea.innerText = 'Invalid bet!';
            return;
        }

        balance -= bet;
        const playerCards = [drawCard(), drawCard()];
        const dealerCards = [drawCard(), drawCard()];

        const playerTotal = calculateTotal(playerCards);
        const dealerTotal = calculateTotal(dealerCards);

        resultArea.innerText = `Your cards: ${playerCards.join(', ')} (Total: ${playerTotal})\nDealer's cards: ${dealerCards[0]}, ?`;

        // Check for blackjack
        if (playerTotal === 21) {
            balance += bet * 2.5; // Player wins with blackjack
            resultArea.innerText += '\nYou hit a Blackjack! You win!';
        } else {
            // Allow player to choose to hit or stand
            const hitButton = document.createElement('button');
            hitButton.innerText = 'Hit';
            hitButton.onclick = function () {
                playerCards.push(drawCard());
                const newPlayerTotal = calculateTotal(playerCards);
                resultArea.innerText = `Your cards: ${playerCards.join(', ')} (Total: ${newPlayerTotal})\nDealer's cards: ${dealerCards[0]}, ?`;

                if (newPlayerTotal > 21) {
                    resultArea.innerText += '\nYou bust! Dealer wins!';
                } else {
                    // Stand logic here (you could add another button for "Stand")
                }
                updateBalanceDisplay();
            };
            gameArea.appendChild(hitButton);
        }

        updateBalanceDisplay();
    };

    gameArea.appendChild(betInput);
    gameArea.appendChild(button);
}

function drawCard() {
    return Math.floor(Math.random() * 10) + 1; // Simulating a card from 1 to 10
}

function calculateTotal(cards) {
    return cards.reduce((total, card) => total + card, 0);
}

// Other game functions remain the same...

// Load the selected game on page load
window.onload = function () {
    const savedGame = localStorage.getItem('selectedGame');
    if (savedGame) {
        document.getElementById('gameSelector').value = savedGame;
        loadGame();
    }
    updateBalanceDisplay();
};
